<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>AVIATOR IA AUTO-LEARNING</title>
<style>
body{background:#05070a;color:white;font-family:Arial;text-align:center}
input,button{padding:10px;margin:5px;font-size:16px}
#res{margin-top:15px}
canvas{margin-top:10px;border:1px solid #333}
.good{color:#00ff88}
.bad{color:#ff4b2b}
</style>
</head>
<body>

<h2>AVIATOR IA AUTO-LEARNING</h2>

<input id="v" type="number" step="0.01" placeholder="Dernier crash">
<input id="s" type="number" placeholder="Seconde">
<br>
<button onclick="predict()">PREDICT</button>

<div id="res"></div>

<button onclick="record(true)">GAGNÉ ✅</button>
<button onclick="record(false)">PERDU ❌</button>

<h3>Score Global IA</h3>
<div id="score">50%</div>

<h3>Heatmap secondes</h3>
<canvas id="heatmap" width="300" height="50"></canvas>

<script>
let wins=0,total=0;
let iaScore=parseInt(localStorage.getItem("iaScore"))||50;
let heat=JSON.parse(localStorage.getItem("heat"))||{};
let lastS=null;

document.getElementById("score").innerText=iaScore+"%";

function predict(){
  const v=parseFloat(v=document.getElementById("v").value);
  const s=parseInt(document.getElementById("s").value);
  if(isNaN(v)||isNaN(s)) return alert("Erreur valeur");

  lastS=s;
  heat[s]=heat[s]||{w:0,l:0};

  let bias=(heat[s].w-heat[s].l)*0.05;
  let pred=(1.8+(s/60)+(v/10)+bias).toFixed(2);

  document.getElementById("res").innerHTML=
    "<h2>"+pred+"x</h2>"+
    "<small>Seconde "+s+" | Bias IA "+bias.toFixed(2)+"</small>";
}

function record(win){
  if(lastS===null)return;
  total++;
  win?wins++:0;

  if(win){
    iaScore+=2;
    heat[lastS].w++;
  }else{
    iaScore-=3;
    heat[lastS].l++;
  }

  iaScore=Math.max(0,Math.min(100,iaScore));

  localStorage.setItem("iaScore",iaScore);
  localStorage.setItem("heat",JSON.stringify(heat));

  document.getElementById("score").innerText=iaScore+"%";
  drawHeat();
}

function drawHeat(){
  const c=document.getElementById("heatmap");
  const ctx=c.getContext("2d");
  ctx.clearRect(0,0,300,50);

  for(let i=0;i<60;i++){
    let d=heat[i]||{w:0,l:0};
    let r=d.w-d.l;
    ctx.fillStyle=r>0?
      `rgba(0,255,0,${Math.min(r/5,1)})`:
      `rgba(255,0,0,${Math.min(-r/5,1)})`;
    ctx.fillRect(i*5,0,5,50);
  }
}
drawHeat();
</script>

</body>
</html>
